# ‚öôÔ∏è AutoRia - –ü–æ–≤–Ω–µ –∫–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

## üìã –û–≥–ª—è–¥

–ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ —Ç–∞ API –∫–ª—é—á—ñ–≤ –¥–ª—è AutoRia –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

---

## üîê –°–∏—Å—Ç–µ–º–∞ –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –ë–µ–∑–ø–µ–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª—é—á—ñ–≤

```
env-config/
‚îú‚îÄ‚îÄ .env.base          # –ë–∞–∑–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–Ω–µ —Å–µ–∫—Ä–µ—Ç–Ω—ñ)
‚îú‚îÄ‚îÄ .env.secrets       # API –∫–ª—é—á—ñ (–ó–ê–®–ò–§–†–û–í–ê–ù–Ü)
‚îú‚îÄ‚îÄ .env.local         # –õ–æ–∫–∞–ª—å–Ω—ñ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—è
‚îî‚îÄ‚îÄ .env.docker        # Docker –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
```

### –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è API –∫–ª—é—á—ñ–≤

```bash
# 1. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install cryptography python-dotenv

# 2. –ó–∞—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ
python backend/scripts/encrypt_keys_for_backend.py

# 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
cat env-config/.env.secrets
# –ö–ª—é—á—ñ —Ç–µ–ø–µ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ —á–µ—Ä–µ–∑ Fernet
```

### –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ)

```python
# backend/config/settings.py
from core.services.encryption_service import decrypt_env_value

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
GOOGLE_MAPS_API_KEY = decrypt_env_value(os.getenv('GOOGLE_MAPS_API_KEY'))
```

---

## üó∫Ô∏è Google Maps API

### 1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è API –∫–ª—é—á–∞

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ https://console.cloud.google.com/
2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ–µ–∫—Ç –∞–±–æ –≤–∏–±—Ä–∞—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π
3. Enable APIs:
   - **Geocoding API** (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
   - **Maps JavaScript API** (–¥–ª—è frontend)
   - **Places API** (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
4. Credentials ‚Üí Create credentials ‚Üí API key
5. –û–±–º–µ–∂–∏—Ç–∏ –∫–ª—é—á (Application restrictions)

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ –ø—Ä–æ–µ–∫—Ç—ñ

```bash
# env-config/.env.secrets
GOOGLE_MAPS_API_KEY=AIzaSyC...your_key_here
```

```python
# backend/apps/ads/services/geocoding_service.py
import googlemaps

gmaps = googlemaps.Client(key=settings.GOOGLE_MAPS_API_KEY)

def geocode_address(address):
    result = gmaps.geocode(address)
    return {
        'lat': result[0]['geometry']['location']['lat'],
        'lng': result[0]['geometry']['location']['lng']
    }
```

### 3. Frontend –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```typescript
// frontend/.env.local
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=AIzaSyC...your_key_here
```

```tsx
// frontend/src/components/Map/GoogleMap.tsx
import { GoogleMap, useLoadScript } from '@react-google-maps/api';

const { isLoaded } = useLoadScript({
  googleMapsApiKey: process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY!,
});
```

---

## üí∞ –í–∞–ª—é—Ç–Ω—ñ API

### PrivatBank API (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –±–µ–∑ –∫–ª—é—á–∞)

```python
# backend/apps/currency/services.py

NBU_API_URL = "https://bank.gov.ua/NBUStatService/v1/statdirectory/exchange"
PRIVATBANK_API_URL = "https://api.privatbank.ua/p24api/pubinfo?exchange&coursid=5"

def fetch_from_nbu(currency='USD'):
    response = requests.get(f"{NBU_API_URL}?valcode={currency}&json")
    return response.json()[0]['rate']
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ**:
- –ë–µ–∑ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
- –õ—ñ–º—ñ—Ç–∏: ~100 req/day
- –ö–µ—à: Redis 24h

---

## üîë OAuth 2.0 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### DummyJSON (–¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è)

```bash
# env-config/.env.secrets
NEXT_PUBLIC_DUMMY_API_BASE_URL=https://dummyjson.com
```

```typescript
// frontend/src/app/api/helpers.ts
const response = await fetch(`${process.env.NEXT_PUBLIC_DUMMY_API_BASE_URL}/auth/login`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ username: 'emilys', password: 'emilyspass' })
});
```

### Backend OAuth (–≤–ª–∞—Å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞)

```python
# backend/apps/auth/views/oauth2_views.py

OAUTH_PROVIDERS = {
    'google': {
        'client_id': os.getenv('GOOGLE_CLIENT_ID'),
        'client_secret': os.getenv('GOOGLE_CLIENT_SECRET'),
        'redirect_uri': 'http://localhost:3000/auth/callback/google'
    }
}
```

---

## üé® AI –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ó–æ–±—Ä–∞–∂–µ–Ω—å (g4f)

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```python
# backend/core/services/ai_image_service.py
from g4f.client import Client

client = Client()

def generate_image(prompt):
    response = client.images.generate(
        model="flux",
        prompt=prompt
    )
    return response.data[0].url
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ**:
- **–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ** (–±–µ–∑ API –∫–ª—é—á–∞)
- Provider: PollinationsAI —á–µ—Ä–µ–∑ g4f
- –õ—ñ–º—ñ—Ç–∏: –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ provider

---

## üìß Email –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### Gmail SMTP

```bash
# env-config/.env.secrets
EMAIL_HOST_USER=your_email@gmail.com
EMAIL_HOST_PASSWORD=your_app_specific_password
```

```python
# backend/config/extra_config/email_config.py
EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = 'smtp.gmail.com'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
```

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è App Password (Gmail)

1. Google Account ‚Üí Security
2. 2-Step Verification (—É–≤—ñ–º–∫–Ω—É—Ç–∏)
3. App passwords ‚Üí Generate
4. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å

---

## üåç i18n –°–∏—Å—Ç–µ–º–∞ (–Ü–Ω—Ç–µ—Ä–Ω–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è)

### Backend (Django)

```python
# backend/config/extra_config/django_core.py
LANGUAGES = [
    ('uk', '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞'),
    ('ru', '–†—É—Å—Å–∫–∏–π'),
    ('en', 'English'),
]

LANGUAGE_CODE = 'uk'
USE_I18N = True
USE_L10N = True
```

### Frontend (Next.js)

```typescript
// frontend/src/contexts/I18nContext.tsx
const AVAILABLE_LOCALES = ['uk', 'ru', 'en'] as const;

// frontend/src/locales/uk.ts
export const uk = {
  common: {
    welcome: '–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ',
    login: '–£–≤—ñ–π—Ç–∏',
    // ...
  }
};
```

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**:
```tsx
import { useI18n } from '@/contexts/I18nContext';

const { t } = useI18n();
return <h1>{t('common.welcome')}</h1>;
```

---

## üå± –ü–æ—á–∞—Ç–∫–æ–≤–µ Seeding (–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ (Docker)

```yaml
# docker-compose.yml
services:
  app:
    command: >
      sh -c "python manage.py migrate &&
             python manage.py create_test_users &&
             python manage.py create_mock_system --quick &&
             python manage.py runserver 0.0.0.0:8000"
```

### –†—É—á–Ω–µ

```bash
# 1. –î–æ–≤—ñ–¥–Ω–∏–∫–∏ (–º–∞—Ä–∫–∏, –º–æ–¥–µ–ª—ñ, —Ä–µ–≥—ñ–æ–Ω–∏)
python manage.py populate_references

# 2. –¢–µ—Å—Ç–æ–≤—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
python manage.py create_test_users

# 3. –ú–æ–∫–æ–≤—ñ –¥–∞–Ω—ñ
python manage.py create_mock_system --quick

# 4. –ü–æ–≤–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ (–∑ LLM)
python manage.py populate_test_system --full
```

**–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ**: [Backend Services](./BACKEND_SERVICES.md#—Å–∏—Å—Ç–µ–º–∞-–≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó-–º–æ–∫–æ–≤–∏—Ö-–¥–∞–Ω–∏—Ö)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### Backend:
- [ ] PostgreSQL –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
- [ ] Redis –ø—Ä–∞—Ü—é—î
- [ ] Google Maps API –∫–ª—é—á –¥–æ–¥–∞–Ω–æ
- [ ] Email SMTP –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
- [ ] –ú—ñ–≥—Ä–∞—Ü—ñ—ó –≤–∏–∫–æ–Ω–∞–Ω—ñ (`python manage.py migrate`)
- [ ] –°—É–ø–µ—Ä—é–∑–µ—Ä —Å—Ç–≤–æ—Ä–µ–Ω–∏–π
- [ ] –î–æ–≤—ñ–¥–Ω–∏–∫–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ
- [ ] Celery –ø—Ä–∞—Ü—é—î

### Frontend:
- [ ] `.env.local` —Å—Ç–≤–æ—Ä–µ–Ω–æ
- [ ] Google Maps –∫–ª—é—á –¥–æ–¥–∞–Ω–æ
- [ ] Backend URL –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
- [ ] NextAuth –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
- [ ] `npm install` –≤–∏–∫–æ–Ω–∞–Ω–æ
- [ ] `npm run dev` –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è

### Infrastructure:
- [ ] Docker Compose –ø—Ä–∞—Ü—é—î
- [ ] Nginx (—è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è)
- [ ] Volumes –¥–ª—è media/static
- [ ] –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ

---

## üîó –ü–æ–≤'—è–∑–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏

- [Infrastructure Setup](./INFRASTRUCTURE_SETUP.md) - Docker, Redis, Nginx
- [Backend Services](./BACKEND_SERVICES.md) - –ú–æ–¥–µ—Ä–∞—Ü—ñ—è, Celery
- [Troubleshooting](./TROUBLESHOOTING.md) - –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

---

**–í–µ—Ä—Å—ñ—è**: 2.0  
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**: 2025-01-25

