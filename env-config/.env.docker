# =============================================================================
# DOCKER ENVIRONMENT OVERRIDES
# =============================================================================
# Переопределения для Docker контейнеров
# Загружается после .env.base и переопределяет значения для Docker среды

# =============================================================================
# ENVIRONMENT DETECTION
# =============================================================================
IS_DOCKER=true
NEXT_PUBLIC_IS_DOCKER=true
DJANGO_ENV=development
DEBUG=true

# =============================================================================
# CORS CONFIGURATION FOR DOCKER
# =============================================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000,http://frontend:3000
CORS_ALLOW_CREDENTIALS=true

# =============================================================================
# FRONTEND DOCKER OVERRIDES
# =============================================================================
# Backend URL для client-side запросов из браузера (внешний URL)
# ВАЖНО: base URL БЕЗ /api, префикс /api добавляется в коде
NEXT_PUBLIC_BACKEND_URL=http://localhost:8000
# Backend URL для server-side запросов внутри Docker (внутренний URL по service name)
BACKEND_URL=http://app:8000
# Базовый URL для медиа-файлов - ПУБЛИЧНЫЙ URL для доступа из браузера
# ВАЖНО: Используем localhost, так как браузер не может разрешить внутренние Docker имена
MEDIA_URL_BASE=http://localhost:8000

# NextAuth URLs для Docker среды
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_URL_INTERNAL=http://frontend:3000

# OAuth ключи определены в .env.secrets согласно принципу DRY

# WebSocket configuration для Docker
NEXT_PUBLIC_WS_BASE_URL=ws://app:8000
NEXT_PUBLIC_WS_PATH=/ws/chat

# =============================================================================
# NEXT.JS RUNTIME CONFIGURATION FOR DOCKER
# =============================================================================
# Force Node.js runtime for middleware to avoid Edge Runtime issues
NEXT_RUNTIME=nodejs
MIDDLEWARE_RUNTIME=nodejs
EDGE_RUNTIME_DISABLED=true

# =============================================================================
# REDIS FOR FRONTEND API ROUTES
# =============================================================================
NEXT_PUBLIC_REDIS_HOST=redis
NEXT_PUBLIC_REDIS_PORT=6379
NEXT_PUBLIC_REDIS_URL=redis://redis:6379/0

# =============================================================================
# DRF THROTTLING SETTINGS FOR DEVELOPMENT
# =============================================================================
# Увеличенные лимиты для разработки
DRF_ANON_RATE=10000/hour
DRF_USER_RATE=50000/hour
DRF_LOGIN_RATE=100/min
DRF_REGISTER_RATE=50/min

# =============================================================================
# SEEDING SETTINGS FOR DOCKER
# =============================================================================
# Включить сидинг данных в Docker
RUN_SEEDS=true
FORCE_RESEED=true

# =============================================================================
# GOOGLE MAPS API KEY (ENCRYPTED)
# =============================================================================
ENCRYPTED_GOOGLE_MAPS_API_KEY="Z0FBQUFBQm9vbXo3RVNGVUhWeVNjRTE2ZVhfZV9TNkNvR2xodnBiaVg3RFRxeHh2azhtN0VpY19KN3Bud0JKdmg4LVlTVVZORks3QXlyclFudG5GUTcwcWp1WXdlaUVaYZTFtRHhKcXNOMXRmNWp1MVFha3lIak5aa1RVSTY2WmtwRG1mM25aV3VEZXg="

# =============================================================================
# GOOGLE MAPS API KEY (ENCRYPTED)
# =============================================================================
ENCRYPTED_GOOGLE_MAPS_API_KEY="Z0FBQUFBQm9vbXo3RVNGVUhWeVNjRTE2ZVhfZV9TNkNvR2xodnBiaVg3RFRxeHh2azhtN0VpY19KN3Bud0JKdmg4LVlTVVZORks3QXlyclFudG5GUTcwcWp1WXdlaUVaYZTFtRHhKcXNOMXRmNWp1MVFha3lIak5aa1RVSTY2WmtwRG1mM25aV3VEZXg="

# =============================================================================
# PostgreSQL Connection Fix (Broken pipe solution)
# =============================================================================
DB_CONN_MAX_AGE=0
DB_CONNECT_TIMEOUT=30
DB_CONN_HEALTH_CHECKS=true
