# 🏷️ Улучшение тултипа бейджа авторизации

## 📌 Задача
Добавить в тултип бейджа логинации информацию о полномочиях пользователя.

## ✅ Реализация

### Компонент: `AutoRiaUserBadge.tsx`

#### 1. **Определение полномочий**

```typescript
// Определяем полномочия пользователя
const isSuperuser = user?.is_superuser || userProfileData?.user?.is_superuser || false;
const isStaff = user?.is_staff || userProfileData?.user?.is_staff || false;
const isModerator = userProfileData?.user?.groups?.some((g: any) => g.name === 'Moderators') || false;

// Собираем список ролей
const roles = [];
if (isSuperuser) roles.push('Суперадміністратор');
if (isStaff && !isSuperuser) roles.push('Співробітник');
if (isModerator && !isSuperuser) roles.push('Модератор');
if (isPremium) roles.push(`${accountType} акаунт`);
if (roles.length === 0) roles.push('Користувач');
```

#### 2. **Структура тултипа**

Тултип теперь содержит **3 секции**:

1. **Информация о пользователе**
   - Имя пользователя (username)
   - Email

2. **Полномочия (Roles)**
   - Список всех ролей с цветовой индикацией:
     - 🔴 **Суперадміністратор** - красный (высший уровень доступа)
     - 🔵 **Модератор** - синий (модерация контента)
     - 🟢 **Співробітник** - зеленый (сотрудник)
     - 🟡 **PREMIUM/VIP акаунт** - янтарный (премиум статус)
     - ⚪ **Користувач** - серый (обычный пользователь)

3. **Подсказка**
   - "Натисніть для переходу до профілю"

#### 3. **Цветовая схема ролей**

| Роль | Светлая тема | Темная тема | Вес |
|------|--------------|-------------|-----|
| Суперадміністратор | `bg-red-100 text-red-700` | `bg-red-900 text-red-200` | **Bold** |
| Модератор | `bg-blue-100 text-blue-700` | `bg-blue-900 text-blue-200` | Normal |
| Співробітник | `bg-green-100 text-green-700` | `bg-green-900 text-green-200` | Normal |
| PREMIUM/VIP | `bg-amber-100 text-amber-700` | `bg-amber-900 text-amber-200` | **Bold** |
| Користувач | `bg-gray-100 text-gray-700` | `bg-gray-700 text-gray-200` | Normal |

#### 4. **Приоритет ролей**

Роли добавляются в следующем порядке приоритета:
1. Суперадміністратор (наивысший)
2. Співробітник (если не суперадмин)
3. Модератор (если не суперадмин)
4. Тип аккаунта (PREMIUM/VIP)
5. Користувач (по умолчанию, если нет других ролей)

## 🎨 Визуальное представление

### Пример тултипа для суперпользователя с Premium аккаунтом:

```
┌─────────────────────────────────────┐
│ John Doe                            │
│ john.doe@example.com                │
├─────────────────────────────────────┤
│ Полномочия:                         │
│ [🔴 Суперадміністратор] [🟡 PREMIUM]│
├─────────────────────────────────────┤
│ Натисніть для переходу до профілю   │
└─────────────────────────────────────┘
```

### Пример тултипа для модератора:

```
┌─────────────────────────────────────┐
│ Jane Smith                          │
│ jane.smith@example.com              │
├─────────────────────────────────────┤
│ Полномочия:                         │
│ [🔵 Модератор]                      │
├─────────────────────────────────────┤
│ Натисніть для переходу до профілю   │
└─────────────────────────────────────┘
```

### Пример тултипа для обычного пользователя:

```
┌─────────────────────────────────────┐
│ Guest User                          │
│ guest@example.com                   │
├─────────────────────────────────────┤
│ Полномочия:                         │
│ [⚪ Користувач]                     │
├─────────────────────────────────────┤
│ Натисніть для переходу до профілю   │
└─────────────────────────────────────┘
```

## 📊 Источники данных

### Проверяются следующие источники:
1. **`user` из `useAutoRiaAuth`**
   - `is_superuser`
   - `is_staff`
   - `username`
   - `email`

2. **`userProfileData` из `useUserProfileData`**
   - `user.is_superuser`
   - `user.is_staff`
   - `user.groups` (для проверки роли модератора)
   - `account.account_type` (PREMIUM/VIP/BASIC)

## ✅ Преимущества

1. **Прозрачность** - пользователь сразу видит все свои полномочия
2. **Визуальная иерархия** - цветовое кодирование помогает быстро определить уровень доступа
3. **Множественные роли** - система корректно отображает пользователей с несколькими ролями
4. **Темная тема** - все цвета адаптированы для обеих тем
5. **Accessibility** - хороший контраст цветов в обеих темах

## 🔒 Безопасность

- Данные о полномочиях берутся из защищенных источников (backend API)
- Нет возможности подделки ролей на клиентской стороне
- Отображение полномочий синхронизировано с реальными правами доступа

## 📱 Адаптивность

- Тултип автоматически подстраивается под размер контента
- Роли отображаются с `flex-wrap`, что позволяет им переноситься на новую строку
- Максимальная ширина тултипа ограничена классом `max-w-xs` для читабельности

