# üìÑ –°–∏—Å—Ç–µ–º–∞ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó - –ö–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –∑ –º—ñ–≥—Ä–∞—Ü—ñ—ó

## üéØ **–û–≥–ª—è–¥ —Å–∏—Å—Ç–µ–º–∏**

–°–∏—Å—Ç–µ–º–∞ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø—ñ **–∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ** —Ç–∞ **–ø–æ—Å—Ç—É–ø–æ–≤–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ –ø—Ä–æ–¥–æ–≤–∂—É—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –∞ –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–æ–¥–∞—é—Ç—å—Å—è –±–µ–∑ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ.

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä–æ–≤**

### **1. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä (Legacy)**
```python
# apps/ads/views/car_ad_views.py
class CarAdPagination(PageNumberPagination):
    """–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π page_size=0"""
    page_size = 50
    page_size_query_param = 'page_size'
    max_page_size = 10000
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `page_size=0` (–≤–æ–∑–≤—Ä–∞—Ç –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤)
- ‚úÖ –ë–æ–ª—å—à–æ–π `max_page_size` –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### **2. –°–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä (Compatible)**
```python
# core/pagination/legacy_compatible_pagination.py
class LegacyCompatiblePagination(PageNumberPagination):
    """–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º CarAdPagination"""
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ 100% —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º API
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π
- ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### **3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä (Optimized)**
```python
# core/pagination/optimized_pagination.py
class OptimizedPageNumberPagination(PageNumberPagination):
    """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é"""
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚ö° –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

### **4. –£–º–Ω—ã–π –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä (Smart)**
```python
# core/pagination/legacy_compatible_pagination.py
class SmartPagination(PageNumberPagination):
    """–£–º–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏"""
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üß† –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö queryset
- üîÑ Fallback –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

## üîÑ **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏**

### **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–¢–µ–∫—É—â–∏–π)**
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä—ã
- ‚úÖ –û–±–µ—Å–ø–µ—á–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω

### **–≠—Ç–∞–ø 2: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è**
```python
# –í settings.py
PAGINATION_MIGRATION = {
    'migrated_views': [
        'CarAdListView',  # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ –º–µ—Ä–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    ],
    'migrated_apps': [
        # 'ads',  # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ
    ]
}
```

### **–≠—Ç–∞–ø 3: –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è**
- üîÑ –í—Å–µ views –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–µ –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä—ã
- üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä–æ–≤
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üõ†Ô∏è **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ**

### **–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö views (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π):**
```python
class CarAdListView(generics.ListAPIView):
    pagination_class = CarAdPagination  # –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
```

### **–î–ª—è –Ω–æ–≤—ã—Ö views:**
```python
from core.pagination.optimized_pagination import OptimizedPageNumberPagination

class NewCarAdListView(generics.ListAPIView):
    pagination_class = OptimizedPageNumberPagination
```

### **–î–ª—è —É–º–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**
```python
from core.pagination.legacy_compatible_pagination import SmartPagination

class SmartListView(generics.ListAPIView):
    pagination_class = SmartPagination
```

## üìä **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä–æ–≤**

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Legacy | Compatible | Optimized | Smart |
|----------------|--------|------------|-----------|-------|
| **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** | ‚úÖ 100% | ‚úÖ 100% | ‚ö†Ô∏è 95% | ‚úÖ 100% |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | üü° –ë–∞–∑–æ–≤–∞—è | üü° –ë–∞–∑–æ–≤–∞—è | üü¢ –í—ã—Å–æ–∫–∞—è | üü¢ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è |
| **page_size=0** | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** | ‚ùå –ù–µ—Ç | üü° –ë–∞–∑–æ–≤—ã–µ | ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ | ‚úÖ –£–º–Ω—ã–µ |
| **–ê–≤—Ç–æ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |

## üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏**

### **1. –í settings.py:**
```python
PAGINATION_MIGRATION = {
    'migrated_views': [
        'CarAdListView',
        'CarAdCreateView',
    ],
    'migrated_apps': [
        # 'ads',  # –ö–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ
    ],
    'performance': {
        'enable_smart_pagination': True,
        'large_queryset_threshold': 10000,
        'enable_caching': True,
    }
}
```

### **2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä–∞:**
```python
from core.pagination.migration_strategy import get_pagination_class_for_view

class MyView(generics.ListAPIView):
    pagination_class = get_pagination_class_for_view('MyView', 'ads')
```

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**

### **1. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ API –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

### **2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚ö° –ù–æ–≤—ã–µ –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- üìä –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üîÑ –£–º–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### **3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- `max_page_size` –æ—Å—Ç–∞–µ—Ç—Å—è 10000
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DoS –∞—Ç–∞–∫

## üöÄ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**

### **–î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ OptimizedPageNumberPagination
from core.pagination.optimized_pagination import OptimizedPageNumberPagination
```

### **–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:**
```python
# –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CarAdPagination
# –ú–∏–≥—Ä–∏—Ä—É–π—Ç–µ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

### **–î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SmartPagination
from core.pagination.legacy_compatible_pagination import SmartPagination
```

## üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∏–≥—Ä–∞—Ü–∏–∏**

### **–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
- üìä –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- üîÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

### **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
# –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOGGING = {
    'loggers': {
        'core.pagination': {
            'level': 'DEBUG',
            'handlers': ['console'],
        }
    }
}
```

## üéØ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–°–∏—Å—Ç–µ–º–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å —É—á–µ—Ç–æ–º:
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏** - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏** - –º–æ–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ —á–∞—Å—Ç—è–º
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –Ω–æ–≤—ã–µ –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç–∏** - –º–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–∞–≥–∏–Ω–∞—Ç–æ—Ä

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏!** üõ°Ô∏è
